// Generated by CoffeeScript 2.7.0
var CWD, consola, executeCopy, fs, path;

fs = require('fs');

path = require('path');

consola = require('consola');

({CWD} = require('../constants'));

executeCopy = function(config) {
  var copyNonCoffeeFiles, entryPath, error, outputPath, ref, stat;
  entryPath = path.join(CWD, config.entry);
  outputPath = path.join(CWD, config.output);
  if (!fs.existsSync(entryPath)) {
    consola.warn(`Entry path does not exist: ${config.entry}`);
    return;
  }
  if ((ref = config.options) != null ? ref.join : void 0) {
    consola.info("Copy skipped (join option is enabled)");
    return;
  }
  if (!fs.existsSync(outputPath)) {
    consola.warn(`Output path does not exist: ${config.output}`);
    return;
  }
  stat = fs.statSync(entryPath);
  if (!stat.isDirectory()) {
    consola.info("Copy skipped (entry is not a directory)");
    return;
  }
  consola.start("Copying non-coffee files...");
  try {
    copyNonCoffeeFiles = function(srcDir, destDir) {
      var destItemPath, i, item, items, len, parentDir, results, srcItemPath;
      items = fs.readdirSync(srcDir);
      results = [];
      for (i = 0, len = items.length; i < len; i++) {
        item = items[i];
        srcItemPath = path.join(srcDir, item);
        destItemPath = path.join(destDir, item);
        stat = fs.statSync(srcItemPath);
        if (stat.isDirectory()) {
          if (!fs.existsSync(destItemPath)) {
            fs.mkdirSync(destItemPath, {
              recursive: true
            });
          }
          results.push(copyNonCoffeeFiles(srcItemPath, destItemPath));
        } else {
          // Skip .coffee and .litcoffee files
          if (item.endsWith('.coffee' || item.endsWith('.litcoffee'))) {
            // Skip
            results.push(null);
          } else {
            // Create parent directory if needed
            parentDir = path.dirname(destItemPath);
            if (!fs.existsSync(parentDir)) {
              fs.mkdirSync(parentDir, {
                recursive: true
              });
            }
            // Copy file
            results.push(fs.copyFileSync(srcItemPath, destItemPath));
          }
        }
      }
      return results;
    };
    copyNonCoffeeFiles(entryPath, outputPath);
    return consola.success("Non-coffee files copied successfully!");
  } catch (error1) {
    error = error1;
    consola.error("Failed to copy non-coffee files:", error);
    throw error;
  }
};

module.exports = executeCopy;
